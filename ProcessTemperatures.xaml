<Activity mc:Ignorable="sap sap2010" x:Class="ProcessTemperatures" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="Settings" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>874.666666666667,984</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ProcessTemperatures_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="27">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Web.Mail</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Xml.Serialization</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="22">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Web</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap2010:Annotation.AnnotationText="This process reads incoming emails and looks for daily Temperature readings and updates the Master file accordingly" DisplayName="ProcessTemperatures" sap:VirtualizedContainerService.HintSize="517.333333333333,879.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="foundTemperatures" />
      <Variable x:TypeArguments="x:String" Name="theTemp" />
      <Variable x:TypeArguments="x:String" Name="theEmployee" />
      <Variable x:TypeArguments="x:Int32" Name="first_char" />
      <Variable x:TypeArguments="x:Int32" Name="second_char" />
      <Variable x:TypeArguments="x:String" Name="theEmployeeTmp" />
      <Variable x:TypeArguments="s:DateTime" Name="theDate" />
      <Variable x:TypeArguments="x:String" Name="theDateTmp" />
      <Variable x:TypeArguments="x:String" Name="theDay" />
      <Variable x:TypeArguments="sd:DataTable" Name="EmployeeData" />
      <Variable x:TypeArguments="x:Int32" Name="theIntCell" />
      <Variable x:TypeArguments="x:String" Name="theStartCellID" />
      <Variable x:TypeArguments="x:Int32" Name="theCurrentRow" />
      <Variable x:TypeArguments="x:String" Name="theCellID" />
      <Variable x:TypeArguments="x:String" Name="theCell" />
      <Variable x:TypeArguments="s:DateTime" Name="theStartOfWeek" />
      <Variable x:TypeArguments="x:String" Default="No" Name="updateYes" />
      <Variable x:TypeArguments="x:String" Name="FName" />
      <Variable x:TypeArguments="x:String" Name="SName" />
      <Variable x:TypeArguments="sd:DataTable" Name="EmployeeData2" />
      <Variable x:TypeArguments="x:Int32" Name="Risk" />
      <Variable x:TypeArguments="x:String" Name="newRow" />
      <Variable x:TypeArguments="x:Int32" Name="theCurrentRow2" />
      <Variable x:TypeArguments="x:String" Name="RiskCell" />
      <Variable x:TypeArguments="x:Int32" Name="Column_Number" />
      <Variable x:TypeArguments="x:String" Name="Column_Name" />
      <Variable x:TypeArguments="x:Int32" Name="modulo" />
      <Variable x:TypeArguments="x:String" Name="theRangeCells" />
      <Variable x:TypeArguments="sd:DataTable" Name="theRange" />
      <Variable x:TypeArguments="x:String" Name="Monday" />
      <Variable x:TypeArguments="x:String" Name="Tuesday" />
      <Variable x:TypeArguments="x:String" Name="Wednesday" />
      <Variable x:TypeArguments="x:String" Name="Thursday" />
      <Variable x:TypeArguments="x:String" Name="Friday" />
      <Variable x:TypeArguments="x:String" Name="Saturday" />
      <Variable x:TypeArguments="x:String" Name="Sunday" />
      <Variable x:TypeArguments="x:String" Name="WFH" />
      <Variable x:TypeArguments="x:String" Name="Travelling" />
      <Variable x:TypeArguments="x:String" Name="Tested" />
      <Variable x:TypeArguments="x:String" Name="Quarantine" />
      <Variable x:TypeArguments="x:String" Name="COVID19" />
      <Variable x:TypeArguments="x:String" Name="PublicTrans" />
      <Variable x:TypeArguments="x:String" Name="NonEmployees" />
      <Variable x:TypeArguments="x:String" Name="OverseasTravel01" />
      <Variable x:TypeArguments="x:String" Name="OverseasTravel02" />
      <Variable x:TypeArguments="x:String" Name="Office" />
      <Variable x:TypeArguments="x:String" Name="Department" />
      <Variable x:TypeArguments="x:String" Name="TempVal" />
      <Variable x:TypeArguments="x:String" Name="theTempINT" />
      <Variable x:TypeArguments="x:String" Name="thisEmployee" />
      <Variable x:TypeArguments="x:String" Name="AllEmployees" />
      <Variable x:TypeArguments="x:String" Name="theTempSTR" />
      <Variable x:TypeArguments="sd:DataTable" Name="EmployeeDataSorted" />
      <Variable x:TypeArguments="sd:DataTable" Name="FilteredEmployees" />
      <Variable x:TypeArguments="sd:DataTable" Name="distributionData" />
      <Variable x:TypeArguments="sd:DataTable" Name="FilteredDistribution" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Put the settings from Config.xlxs into a dictionary called SETTINGS" DisplayName="Getting the settings from Config.xlxs" sap:VirtualizedContainerService.HintSize="475.333333333333,132" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="InitAllSettings.xaml">
      <ui:InvokeWorkflowFile.Arguments>
        <InArgument x:TypeArguments="x:String" x:Key="in_ConfigFile">Config.xlsx</InArgument>
        <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="out_Config">[Settings]</OutArgument>
      </ui:InvokeWorkflowFile.Arguments>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:InvokeWorkflowFile>
    <ui:GetOutlookMailMessages Account="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Find the Daily Survey Emails only" Filter="[subject]='Your Daily Health Check'" GetAttachements="False" sap:VirtualizedContainerService.HintSize="475.333333333333,22" sap2010:WorkflowViewState.IdRef="GetOutlookMailMessages_1" MailFolder="Inbox" MarkAsRead="True" Messages="[foundTemperatures]" OnlyUnreadMessages="True" Top="30" />
    <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each Daily Survey Email" sap:VirtualizedContainerService.HintSize="475.333333333333,508" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[foundTemperatures]">
      <ui:ForEach.Body>
        <ActivityAction x:TypeArguments="snm:MailMessage">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="message" />
          </ActivityAction.Argument>
          <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438.666666666667,369.333333333333" sap2010:WorkflowViewState.IdRef="TryCatch_1">
            <TryCatch.Try>
              <Sequence sap2010:Annotation.AnnotationText="If we find some Daily Survey emails - process them - otherwise stop" DisplayName="Process Emails" sap:VirtualizedContainerService.HintSize="924.666666666667,9861.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_2">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign DisplayName="Find the Employee Name" sap:VirtualizedContainerService.HintSize="882.666666666667,62" sap2010:WorkflowViewState.IdRef="Assign_4">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[theEmployeeTmp]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[message.from.ToString]</InArgument>
                  </Assign.Value>
                </Assign>
                <ui:MultipleAssign sap2010:Annotation.AnnotationText="Calculate data from the email and email body" DisplayName="Calculate Some Field Data" sap:VirtualizedContainerService.HintSize="882.666666666667,526.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[first_char]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">[theEmployeeTmp.IndexOf("&lt;")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[second_char]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">[theEmployeeTmp.LastIndexOf("&gt;")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theEmployee]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theEmployeeTmp.Substring(first_char+1,(second_char - first_char-1))]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[message.body]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theTemp.Substring(0,7).trim()]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_100">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[If(theTemp.Length &lt; 1,"0",theTemp)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_99">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTempSTR]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_95">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTempINT]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(theTemp, “[^0-9\.]”, “”)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theDateTmp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[message.Headers("Date").ToString]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theDateTmp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theDateTmp.Substring(0,10)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">[theDate]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">[Datetime.ParseExact(theDateTmp,“MM/dd/yyyy”,System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theDay]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theDate.DayOfWeek.ToString]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">[theStartOfWeek]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">[theDate.AddDays((theDate.DayOfWeek - DayOfWeek.Monday) * -1)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[updateYes]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">No</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <If Condition="[theTempINT.length&gt;1]" DisplayName="Check we have a valid temperature value" sap:VirtualizedContainerService.HintSize="882.666666666667,405.333333333333" sap2010:WorkflowViewState.IdRef="If_8">
                  <If.Then>
                    <Assign DisplayName="If numeric temperature found in email bidy" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_37">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">[theTempINT]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </If.Then>
                  <If.Else>
                    <Sequence sap2010:Annotation.AnnotationText="If temperature is HIGH then set to 40&#xA;If NORMAL set to 36&#xA;Anything else set to 0" DisplayName="If non-numeric temperature " sap:VirtualizedContainerService.HintSize="380,251.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_12">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:MultipleAssign DisplayName="Set the temperature value" sap:VirtualizedContainerService.HintSize="338,97.3333333333333" sap2010:WorkflowViewState.IdRef="MultipleAssign_11">
                        <ui:MultipleAssign.AssignOperations>
                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_96">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[IF(IsNumeric(theTempStr), theTempStr, IF((theTempStr.trim).ToUpper= "HIGH",“40”,IF((theTempStr.trim).ToUpper= "NORMAL",“36”,“0”)))]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                          </scg:List>
                        </ui:MultipleAssign.AssignOperations>
                      </ui:MultipleAssign>
                    </Sequence>
                  </If.Else>
                </If>
                <If Condition="[theTemp=&quot;0&quot;]" DisplayName="If temperature value is 0 = UNKNOWN then STOP" sap:VirtualizedContainerService.HintSize="882.666666666667,521.333333333333" sap2010:WorkflowViewState.IdRef="If_9">
                  <If.Then>
                    <Sequence DisplayName="Send an Error Email Notification" sap:VirtualizedContainerService.HintSize="376,367.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_13">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Send the error notification email" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_3" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                      <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Move the original email to the Exceptions queue" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_4" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                      <Throw DisplayName="STOP - no temperature value found" Exception="[new BusinessRuleException(&quot;Temperature for this reply email is: Unknown&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_1" />
                    </Sequence>
                  </If.Then>
                </If>
                <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Move the email to the Processed Queue" sap:VirtualizedContainerService.HintSize="882.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_2" MailFolder="[Settings(&quot;HARIAArchiveQueue&quot;).ToString]" MailMessage="[message]" />
                <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="Get current employees details from the DISTRIBUTION sheet" DisplayName="Get the employee basic information" sap:VirtualizedContainerService.HintSize="882.666666666667,1752" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_2" WorkbookPath="[Settings(&quot;MasterPath&quot;).ToString]">
                  <ui:ExcelApplicationScope.Body>
                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Start Processing" sap:VirtualizedContainerService.HintSize="660.666666666667,1612.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_18">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ExcelReadRange AddHeaders="True" DataTable="[distributionData]" DisplayName="Get the Distribution list" sap:VirtualizedContainerService.HintSize="618.666666666667,58.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelReadRange_6" SheetName="Distribution">
                          <ui:ExcelReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ExcelReadRange.Range>
                        </ui:ExcelReadRange>
                        <ui:FilterDataTable DataTable="[distributionData]" DisplayName="Filter the list to just this employee" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="618.666666666667,58.6666666666667" sap2010:WorkflowViewState.IdRef="FilterDataTable_2" OutputDataTable="[FilteredDistribution]" SelectColumnsMode="Keep">
                          <ui:FilterDataTable.Filters>
                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                              <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                <ui:FilterOperationArgument.Column>
                                  <InArgument x:TypeArguments="x:String">["Email"]</InArgument>
                                </ui:FilterOperationArgument.Column>
                                <ui:FilterOperationArgument.Operand>
                                  <InArgument x:TypeArguments="x:String">[theEmployee]</InArgument>
                                </ui:FilterOperationArgument.Operand>
                              </ui:FilterOperationArgument>
                            </scg:List>
                          </ui:FilterDataTable.Filters>
                          <ui:FilterDataTable.SelectColumns>
                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                              <x:Null />
                            </scg:List>
                          </ui:FilterDataTable.SelectColumns>
                        </ui:FilterDataTable>
                        <If Condition="[FilteredDistribution.Rows.Count &lt; 1]" DisplayName="If employee NOT FOUND" sap:VirtualizedContainerService.HintSize="618.666666666667,610" sap2010:WorkflowViewState.IdRef="If_10">
                          <If.Then>
                            <Sequence DisplayName="Send exception" sap:VirtualizedContainerService.HintSize="418,459.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_15">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Send an Error Email Notification" sap:VirtualizedContainerService.HintSize="376,367.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_14">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Send the error notification email" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_5" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                                <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Move the original email to the Exceptions queue" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_6" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                                <Throw DisplayName="STOP - Unknown employee" Exception="[new BusinessRuleException(&quot;Temperature for this reply email is: Unknown&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_2" />
                              </Sequence>
                            </Sequence>
                          </If.Then>
                        </If>
                        <ui:ForEachRow CurrentIndex="[theCurrentRow]" DataTable="[FilteredDistribution]" DisplayName="If Employee is in the Distribution List" sap:VirtualizedContainerService.HintSize="618.666666666667,673.333333333333" sap2010:WorkflowViewState.IdRef="ForEachRow_3">
                          <ui:ForEachRow.Body>
                            <ActivityAction x:TypeArguments="sd:DataRow">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="thisEmployee" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Determine the employee details" sap:VirtualizedContainerService.HintSize="568,524" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[thisEmployee.Item(&quot;Email&quot;).ToString.Contains(theEmployee)]" DisplayName="If we have a matching Employee" sap:VirtualizedContainerService.HintSize="526,432" sap2010:WorkflowViewState.IdRef="If_11">
                                  <If.Then>
                                    <Sequence sap2010:Annotation.AnnotationText="Save the employee details for later" DisplayName="Get the employee details" sap:VirtualizedContainerService.HintSize="380,281.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_16">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,158.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_12">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_101">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[FName]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[thisEmployee.Item("First Name").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_102">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[SName]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[thisEmployee.Item("Last Name").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_103">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Department]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[thisEmployee.Item("Department").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                    </Sequence>
                                  </If.Then>
                                </If>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEachRow.Body>
                        </ui:ForEachRow>
                      </Sequence>
                    </ActivityAction>
                  </ui:ExcelApplicationScope.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ExcelApplicationScope>
                <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="Now loop through the Master File sheet and update any existing weekly row matching the data and employee in the email" DisplayName="Update The Existing Weekly Entry" sap:VirtualizedContainerService.HintSize="882.666666666667,6144.66666666667" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" WorkbookPath="[Settings(&quot;MasterPath&quot;).ToString]">
                  <ui:ExcelApplicationScope.Body>
                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="848.666666666667,6005.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_3">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ExcelReadRange AddHeaders="True" DataTable="[EmployeeData]" DisplayName="Read the Master File" sap:VirtualizedContainerService.HintSize="806.666666666667,58.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelReadRange_7" SheetName="Master File">
                          <ui:ExcelReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ExcelReadRange.Range>
                        </ui:ExcelReadRange>
                        <ui:ForEachRow CurrentIndex="[theCurrentRow]" DataTable="[EmployeeData]" DisplayName="For Each Row found in the Master File" sap:VirtualizedContainerService.HintSize="806.666666666667,3355.33333333333" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                          <ui:ForEachRow.Body>
                            <ActivityAction x:TypeArguments="sd:DataRow">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="employee" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Process the details" sap:VirtualizedContainerService.HintSize="726.666666666667,3206" sap2010:WorkflowViewState.IdRef="Sequence_4">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[employee.Item(&quot;Email&quot;).ToString.Contains(theEmployee) and employee.Item(&quot;Week Start&quot;).ToString.Contains(theStartofWeek.ToString)]" DisplayName="If we have a matching Date and Employee" sap:VirtualizedContainerService.HintSize="684.666666666667,3114" sap2010:WorkflowViewState.IdRef="If_3">
                                  <If.Then>
                                    <Sequence DisplayName="Sequence - get values and set the col and row" sap:VirtualizedContainerService.HintSize="538.666666666667,2963.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_5">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign DisplayName="Determine the cell IDs" sap:VirtualizedContainerService.HintSize="496.666666666667,281.333333333333" sap2010:WorkflowViewState.IdRef="MultipleAssign_8">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_82">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[theCell]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[EmployeeData.Columns.IndexOf(theDay).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_104">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Int32">[theIntCell]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Int32">[Int32.parse(theCell)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_83">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Int32">[modulo]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Int32">[(theIntCell) mod 26]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_84">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Column_Name]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[Convert.ToChar(65 + modulo).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_85">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[theCellID]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[Column_Name + (theCurrentRow + 2).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_86">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[theStartCellID]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">["A" + (theCurrentRow + 2).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_87">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[RiskCell]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">["G" + (theCurrentRow + 2).ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <ui:ExcelWriteCell Cell="[theCellID]" DisplayName="Write Temperature Value to Cell" sap:VirtualizedContainerService.HintSize="496.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_18" SheetName="Master File" Text="[theTemp]" />
                                      <ui:MultipleAssign DisplayName="Read all the existing data for this row" sap:VirtualizedContainerService.HintSize="496.666666666667,588" sap2010:WorkflowViewState.IdRef="MultipleAssign_5">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="32">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_52">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Monday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Monday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_53">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Tuesday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Tuesday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_54">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Wednesday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Wednesday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_55">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Thursday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Thursday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_56">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Friday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Friday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_57">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Saturday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Saturday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_58">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Sunday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Sunday").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_59">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[WFH]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("WFH").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_60">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Travelling]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Travelling").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_61">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Office]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Office City").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_62">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Tested]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Tested").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_63">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Quarantine]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Quaratined").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_64">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[COVID19]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("COVID19-Contact").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_65">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[PublicTrans]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Public Transport").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_66">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[NonEmployees]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Non Employees").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_67">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[OverseasTravel01]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Overseas Country 1").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_68">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[OverseasTravel02]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[employee.Item("Overseas Country 2").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <Switch x:TypeArguments="x:String" DisplayName="Pick Up The New Temperature Value" Expression="[Column_Name]" sap:VirtualizedContainerService.HintSize="496.666666666667,282" sap2010:WorkflowViewState.IdRef="Switch`1_1">
                                        <Assign x:Key="H" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_30">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Monday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign x:Key="I" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_31">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Tuesday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign x:Key="J" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_32">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Wednesday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign x:Key="K" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_33">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Thursday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign x:Key="L" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_34">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Friday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign x:Key="M" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_35">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Saturday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <Assign x:Key="N" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_36">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[Sunday]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </Switch>
                                      <ui:MultipleAssign DisplayName="Change any NULL to 0" sap:VirtualizedContainerService.HintSize="496.666666666667,281.333333333333" sap2010:WorkflowViewState.IdRef="MultipleAssign_6">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="32">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_69">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Monday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Monday),"0",Monday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_70">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Tuesday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Tuesday),"0",Tuesday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_71">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Wednesday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Wednesday),"0",Wednesday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_72">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Thursday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Thursday),"0",Thursday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_73">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Friday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Friday),"0",Friday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_74">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Saturday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Saturday),"0",Saturday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_75">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Sunday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[if(string.IsNullorEmpty(Sunday),"0",Sunday)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <ui:MultipleAssign sap2010:Annotation.AnnotationText="We need to calulate a Risk Score, so need our data as  integers" DisplayName="Convert String values to Integers" sap:VirtualizedContainerService.HintSize="496.666666666667,633.333333333333" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="32">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_35">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Monday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Monday) &gt;37,"3","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_36">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Tuesday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Tuesday)&gt;37,“3”,“0”)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_37">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Wednesday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Wednesday)&gt;37,“3”,“0”)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Thursday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Thursday)&gt;37,“3”,“0”)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Friday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Friday)&gt;37,“3”,“0”)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_40">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Saturday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Saturday)&gt;37,“3”,“0”)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Sunday]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(CInt(Sunday)&gt;37,“3”,“0”)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[WFH]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[If(WFH="Yes","0","2")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_43">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Travelling]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(Travelling="Yes","2","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_44">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Office]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[If(Office.Length&gt;2,"1","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_45">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Tested]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(Travelling="Yes","1","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_46">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Quarantine]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(Quarantine="Yes","1","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_47">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[COVID19]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(COVID19="Yes","9","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_48">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[PublicTrans]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(PublicTrans="Yes","2","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_49">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[NonEmployees]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(NonEmployees="Yes","1","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_50">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[OverseasTravel01]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(OverseasTravel01="Yes","3","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_51">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[OverseasTravel02]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[IF(OverseasTravel02="Yes","3","0")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:MultipleAssign>
                                      <Assign DisplayName="Calculate RISK Indicator" sap:VirtualizedContainerService.HintSize="496.666666666667,62" sap2010:WorkflowViewState.IdRef="Assign_29">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Int32">[Risk]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Int32">[convert.ToInt32(Monday) + convert.ToInt32(Tuesday) + convert.ToInt32(Wednesday) + convert.ToInt32(Thursday) + convert.ToInt32(Friday) + convert.ToInt32(Saturday) + convert.ToInt32(Sunday) + convert.ToInt32(WFH) + convert.ToInt32(Office) + convert.ToInt32(Travelling) + convert.ToInt32(Tested) + convert.ToInt32(Quarantine) + convert.ToInt32(COVID19) + convert.ToInt32(PublicTrans) + convert.ToInt32(NonEmployees) + convert.ToInt32(OverseasTravel01) + convert.ToInt32(OverseasTravel02)]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:ExcelWriteCell Cell="[RiskCell]" DisplayName="Write Risk Inidcator Value to Cell" sap:VirtualizedContainerService.HintSize="496.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_16" SheetName="Master File" Text="[Risk.ToString]" />
                                      <ui:ExcelWriteCell sap2010:Annotation.AnnotationText="log when did we just updated this row?" Cell="[&quot;AG&quot; + (theCurrentRow2 + 2).ToString]" DisplayName="Write update Date" sap:VirtualizedContainerService.HintSize="496.666666666667,117.333333333333" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_20" SheetName="Master File" Text="[now.ToShortDateString]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ExcelWriteCell>
                                      <Assign sap2010:Annotation.AnnotationText="Have we just performed an update ?" DisplayName="Set Update Flag" sap:VirtualizedContainerService.HintSize="496.666666666667,92.6666666666667" sap2010:WorkflowViewState.IdRef="Assign_12">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[updateYes]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">Yes</InArgument>
                                        </Assign.Value>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </Assign>
                                    </Sequence>
                                  </If.Then>
                                </If>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEachRow.Body>
                        </ui:ForEachRow>
                        <If Condition="[updateYes = &quot;No&quot;]" DisplayName="If UPDATE failed this must be a new entry" sap:VirtualizedContainerService.HintSize="806.666666666667,2419.33333333333" sap2010:WorkflowViewState.IdRef="If_4">
                          <If.Then>
                            <Sequence DisplayName="Add a new row (at end of exitsing rows)" sap:VirtualizedContainerService.HintSize="660.666666666667,2268.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_7">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelWriteCell Cell="[&quot;A&quot;+ str(EmployeeData.Rows.Count + 2).trim()]" DisplayName="Write Start Of Week Cell" sap:VirtualizedContainerService.HintSize="618.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_6" SheetName="Master File" Text="[theStartofWeek.ToString]" />
                              <ui:ExcelWriteCell Cell="[&quot;B&quot;+ str(EmployeeData.Rows.Count + 2).trim()]" DisplayName="Write Employee Email" sap:VirtualizedContainerService.HintSize="618.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_7" SheetName="Master File" Text="[theEmployee]" />
                              <ui:ExcelWriteCell Cell="[&quot;C&quot;+ str(EmployeeData.Rows.Count + 2).trim()]" DisplayName="Write First Name" sap:VirtualizedContainerService.HintSize="618.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_22" SheetName="Master File" Text="[FName]" />
                              <ui:ExcelWriteCell Cell="[&quot;D&quot;+ str(EmployeeData.Rows.Count + 2).trim()]" DisplayName="Write Last Name" sap:VirtualizedContainerService.HintSize="618.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_23" SheetName="Master File" Text="[SName]" />
                              <ui:ExcelWriteCell Cell="[&quot;E&quot;+ str(EmployeeData.Rows.Count + 2).trim()]" DisplayName="Write Employee Department" sap:VirtualizedContainerService.HintSize="618.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_24" SheetName="Master File" Text="[Department]" />
                              <ui:ExcelReadRange AddHeaders="True" sap2010:Annotation.AnnotationText="Now we updated the Master File we must re-read it into memory (datafile)" DataTable="[EmployeeData2]" DisplayName="Read Range Again with the new values" sap:VirtualizedContainerService.HintSize="618.666666666667,104" sap2010:WorkflowViewState.IdRef="ExcelReadRange_2" SheetName="Master File">
                                <ui:ExcelReadRange.Range>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </ui:ExcelReadRange.Range>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ExcelReadRange>
                              <ui:ForEachRow CurrentIndex="[theCurrentRow2]" DataTable="[EmployeeData2]" DisplayName="Now loop thorugh the new updated Master File" sap:VirtualizedContainerService.HintSize="618.666666666667,1399.33333333333" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                                <ui:ForEachRow.Body>
                                  <ActivityAction x:TypeArguments="sd:DataRow">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="sd:DataRow" Name="employee2" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Process" sap:VirtualizedContainerService.HintSize="568,1250" sap2010:WorkflowViewState.IdRef="Sequence_10">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[employee2.Item(&quot;Email&quot;).ToString.Contains(theEmployee) and employee2.Item(&quot;Week Start&quot;).ToString.Contains(theStartofWeek.ToString)]" DisplayName="When we find the new row" sap:VirtualizedContainerService.HintSize="526,1158" sap2010:WorkflowViewState.IdRef="If_5">
                                        <If.Then>
                                          <Sequence sap2010:Annotation.AnnotationText="As this is a new row, there will be no existing data, only our Temperature from the email" DisplayName="Update the cells" sap:VirtualizedContainerService.HintSize="380,1007.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_9">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:MultipleAssign DisplayName="Set the basic fields" sap:VirtualizedContainerService.HintSize="338,128" sap2010:WorkflowViewState.IdRef="MultipleAssign_9">
                                              <ui:MultipleAssign.AssignOperations>
                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_89">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:String">[theCell]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:String">[EmployeeData2.Columns.IndexOf(theDay).ToString]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_91">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:String">[If(theTemp.Length &lt; 1,"0",theTemp)]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                </scg:List>
                                              </ui:MultipleAssign.AssignOperations>
                                            </ui:MultipleAssign>
                                            <ui:MultipleAssign DisplayName="Calc the Cell Positions" sap:VirtualizedContainerService.HintSize="338,220" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                                              <ui:MultipleAssign.AssignOperations>
                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_76">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[theIntCell]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[Int32.parse(theCell)]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_77">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[modulo]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[(theIntCell) mod 26]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_78">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:String">[Column_Name]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:String">[Convert.ToChar(65 + modulo).ToString]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_79">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:String">[theCellID]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:String">[Column_Name + (theCurrentRow2 + 2).ToString]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_81">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Int32">[Risk]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Int32">[IF(CInt(theTemp) &gt;37,3,0)]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                </scg:List>
                                              </ui:MultipleAssign.AssignOperations>
                                            </ui:MultipleAssign>
                                            <ui:ExcelWriteCell Cell="[theCellID]" DisplayName="Write Temperature" sap:VirtualizedContainerService.HintSize="338,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_10" SheetName="Master File" Text="[theTemp]" />
                                            <ui:ExcelWriteCell Cell="[&quot;G&quot; + (theCurrentRow2 + 2).ToString]" DisplayName="Write Risk Score" sap:VirtualizedContainerService.HintSize="338,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_17" SheetName="Master File" Text="[Risk.ToString]" />
                                            <ui:ExcelWriteCell Cell="[&quot;AG&quot; + (theCurrentRow2 + 2).ToString]" DisplayName="Write Updated on Date" sap:VirtualizedContainerService.HintSize="338,86.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelWriteCell_19" SheetName="Master File" Text="[now.ToShortDateString]" />
                                            <Assign DisplayName="Did we just update this row" sap:VirtualizedContainerService.HintSize="338,62" sap2010:WorkflowViewState.IdRef="Assign_20">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[updateYes]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">Yes</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEachRow.Body>
                              </ui:ForEachRow>
                            </Sequence>
                          </If.Then>
                        </If>
                      </Sequence>
                    </ActivityAction>
                  </ui:ExcelApplicationScope.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ExcelApplicationScope>
              </Sequence>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404.666666666667,22" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                  </ActivityAction.Argument>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,94.6666666666667" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Error" Message="[exception.Source.ToString+&quot; &quot;+ exception.Message.ToString]" />
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </ActivityAction>
      </ui:ForEach.Body>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:ForEach>
  </Sequence>
</Activity>