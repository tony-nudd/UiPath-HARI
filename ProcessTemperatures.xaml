<Activity mc:Ignorable="sap sap2010" x:Class="ProcessTemperatures" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="Settings" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1264,944</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ProcessTemperatures_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="27">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Web.Mail</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Xml.Serialization</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="22">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Web</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap2010:Annotation.AnnotationText="This process reads incoming emails and looks for daily Temperature readings and updates the Master file accordingly" DisplayName="ProcessTemperatures" sap:VirtualizedContainerService.HintSize="517.333333333333,879.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="foundTemperatures" />
      <Variable x:TypeArguments="x:String" Name="theTemp" />
      <Variable x:TypeArguments="x:String" Name="theEmployee" />
      <Variable x:TypeArguments="x:Int32" Name="first_char" />
      <Variable x:TypeArguments="x:Int32" Name="second_char" />
      <Variable x:TypeArguments="x:String" Name="theEmployeeTmp" />
      <Variable x:TypeArguments="s:DateTime" Name="theDate" />
      <Variable x:TypeArguments="x:String" Name="theDateTmp" />
      <Variable x:TypeArguments="x:String" Name="theDay" />
      <Variable x:TypeArguments="sd:DataTable" Name="EmployeeData" />
      <Variable x:TypeArguments="x:Int32" Name="theIntCell" />
      <Variable x:TypeArguments="x:String" Name="theStartCellID" />
      <Variable x:TypeArguments="x:Int32" Name="theCurrentRow" />
      <Variable x:TypeArguments="x:String" Name="theCellID" />
      <Variable x:TypeArguments="x:String" Name="theCell" />
      <Variable x:TypeArguments="s:DateTime" Name="theStartOfWeek" />
      <Variable x:TypeArguments="x:String" Default="No" Name="updateYes" />
      <Variable x:TypeArguments="x:String" Name="FName" />
      <Variable x:TypeArguments="x:String" Name="SName" />
      <Variable x:TypeArguments="sd:DataTable" Name="EmployeeData2" />
      <Variable x:TypeArguments="x:Int32" Name="Risk" />
      <Variable x:TypeArguments="x:String" Name="newRow" />
      <Variable x:TypeArguments="x:Int32" Name="theCurrentRow2" />
      <Variable x:TypeArguments="x:String" Name="RiskCell" />
      <Variable x:TypeArguments="x:Int32" Name="Column_Number" />
      <Variable x:TypeArguments="x:String" Name="Column_Name" />
      <Variable x:TypeArguments="x:Int32" Name="modulo" />
      <Variable x:TypeArguments="x:String" Name="theRangeCells" />
      <Variable x:TypeArguments="sd:DataTable" Name="theRange" />
      <Variable x:TypeArguments="x:String" Name="Monday" />
      <Variable x:TypeArguments="x:String" Name="Tuesday" />
      <Variable x:TypeArguments="x:String" Name="Wednesday" />
      <Variable x:TypeArguments="x:String" Name="Thursday" />
      <Variable x:TypeArguments="x:String" Name="Friday" />
      <Variable x:TypeArguments="x:String" Name="Saturday" />
      <Variable x:TypeArguments="x:String" Name="Sunday" />
      <Variable x:TypeArguments="x:String" Name="WFH" />
      <Variable x:TypeArguments="x:String" Name="Travelling" />
      <Variable x:TypeArguments="x:String" Name="Tested" />
      <Variable x:TypeArguments="x:String" Name="Quarantine" />
      <Variable x:TypeArguments="x:String" Name="COVID19" />
      <Variable x:TypeArguments="x:String" Name="PublicTrans" />
      <Variable x:TypeArguments="x:String" Name="NonEmployees" />
      <Variable x:TypeArguments="x:String" Name="OverseasTravel01" />
      <Variable x:TypeArguments="x:String" Name="OverseasTravel02" />
      <Variable x:TypeArguments="x:String" Name="Office" />
      <Variable x:TypeArguments="x:String" Name="Department" />
      <Variable x:TypeArguments="x:String" Name="TempVal" />
      <Variable x:TypeArguments="x:String" Name="theTempINT" />
      <Variable x:TypeArguments="x:String" Name="thisEmployee" />
      <Variable x:TypeArguments="x:String" Name="AllEmployees" />
      <Variable x:TypeArguments="x:String" Name="theTempSTR" />
      <Variable x:TypeArguments="sd:DataTable" Name="EmployeeDataSorted" />
      <Variable x:TypeArguments="sd:DataTable" Name="FilteredEmployees" />
      <Variable x:TypeArguments="sd:DataTable" Name="distributionData" />
      <Variable x:TypeArguments="sd:DataTable" Name="FilteredDistribution" />
      <Variable x:TypeArguments="x:String" Name="MasterFile" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Put the settings from Config.xlxs into a dictionary called SETTINGS" DisplayName="Getting the settings from Config.xlxs" sap:VirtualizedContainerService.HintSize="475.333333333333,132" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="InitAllSettings.xaml">
      <ui:InvokeWorkflowFile.Arguments>
        <InArgument x:TypeArguments="x:String" x:Key="in_ConfigFile">Config.xlsx</InArgument>
        <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="out_Config">[Settings]</OutArgument>
      </ui:InvokeWorkflowFile.Arguments>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:InvokeWorkflowFile>
    <ui:GetOutlookMailMessages Account="{x:Null}" TimeoutMS="{x:Null}" DisplayName="Find the Daily Survey Emails only" Filter="[subject]='Your Daily Health Check'" GetAttachements="False" sap:VirtualizedContainerService.HintSize="475.333333333333,22" sap2010:WorkflowViewState.IdRef="GetOutlookMailMessages_1" MailFolder="Inbox" MarkAsRead="True" Messages="[foundTemperatures]" OnlyUnreadMessages="True" Top="30" />
    <ui:ForEach x:TypeArguments="snm:MailMessage" CurrentIndex="{x:Null}" DisplayName="For Each Daily Survey Email" sap:VirtualizedContainerService.HintSize="475.333333333333,508" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[foundTemperatures]">
      <ui:ForEach.Body>
        <ActivityAction x:TypeArguments="snm:MailMessage">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="snm:MailMessage" Name="message" />
          </ActivityAction.Argument>
          <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="438.666666666667,369.333333333333" sap2010:WorkflowViewState.IdRef="TryCatch_1">
            <TryCatch.Try>
              <Sequence sap2010:Annotation.AnnotationText="If we find some Daily Survey emails - process them - otherwise stop" DisplayName="Process Emails" sap:VirtualizedContainerService.HintSize="736.666666666667,3905.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_2">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Assign DisplayName="Find the Employee Name" sap:VirtualizedContainerService.HintSize="694.666666666667,62" sap2010:WorkflowViewState.IdRef="Assign_4">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[theEmployeeTmp]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[message.from.ToString]</InArgument>
                  </Assign.Value>
                </Assign>
                <ui:MultipleAssign sap2010:Annotation.AnnotationText="Calculate data from the email and email body" DisplayName="Calculate Some Field Data" sap:VirtualizedContainerService.HintSize="694.666666666667,526.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
                  <ui:MultipleAssign.AssignOperations>
                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[first_char]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">[theEmployeeTmp.IndexOf("&lt;")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:Int32">[second_char]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:Int32">[theEmployeeTmp.LastIndexOf("&gt;")]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theEmployee]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theEmployeeTmp.Substring(first_char+1,(second_char - first_char-1))]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[message.body]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theTemp.Substring(0,7).trim()]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_100">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[If(theTemp.Length &lt; 1,"0",theTemp)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_99">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTempSTR]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theTemp]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_95">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theTempINT]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(theTemp, “[^0-9\.]”, “”)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theDateTmp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[message.Headers("Date").ToString]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theDateTmp]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theDateTmp.Substring(0,10)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">[theDate]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">[Datetime.ParseExact(theDateTmp,“MM/dd/yyyy”,System.Globalization.CultureInfo.InvariantCulture)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[theDay]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">[theDate.DayOfWeek.ToString]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="s:DateTime">[theStartOfWeek]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="s:DateTime">[theDate.AddDays((theDate.DayOfWeek - DayOfWeek.Monday) * -1)]</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                        <ui:AssignOperation.To>
                          <OutArgument x:TypeArguments="x:String">[updateYes]</OutArgument>
                        </ui:AssignOperation.To>
                        <ui:AssignOperation.Value>
                          <InArgument x:TypeArguments="x:String">No</InArgument>
                        </ui:AssignOperation.Value>
                      </ui:AssignOperation>
                    </scg:List>
                  </ui:MultipleAssign.AssignOperations>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:MultipleAssign>
                <If Condition="[theTempINT.length&gt;1]" DisplayName="Check we have a valid temperature value" sap:VirtualizedContainerService.HintSize="694.666666666667,405.333333333333" sap2010:WorkflowViewState.IdRef="If_8">
                  <If.Then>
                    <Assign DisplayName="If numeric temperature found in email bidy" sap:VirtualizedContainerService.HintSize="262,62" sap2010:WorkflowViewState.IdRef="Assign_37">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">[theTempINT]</InArgument>
                      </Assign.Value>
                    </Assign>
                  </If.Then>
                  <If.Else>
                    <Sequence sap2010:Annotation.AnnotationText="If temperature is HIGH then set to 40&#xA;If NORMAL set to 36&#xA;Anything else set to 0" DisplayName="If non-numeric temperature " sap:VirtualizedContainerService.HintSize="380,251.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_12">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:MultipleAssign DisplayName="Set the temperature value" sap:VirtualizedContainerService.HintSize="338,97.3333333333333" sap2010:WorkflowViewState.IdRef="MultipleAssign_11">
                        <ui:MultipleAssign.AssignOperations>
                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_96">
                              <ui:AssignOperation.To>
                                <OutArgument x:TypeArguments="x:String">[theTemp]</OutArgument>
                              </ui:AssignOperation.To>
                              <ui:AssignOperation.Value>
                                <InArgument x:TypeArguments="x:String">[IF(IsNumeric(theTempStr), theTempStr, IF((theTempStr.trim).ToUpper= "HIGH",“40”,IF((theTempStr.trim).ToUpper= "NORMAL",“36”,“0”)))]</InArgument>
                              </ui:AssignOperation.Value>
                            </ui:AssignOperation>
                          </scg:List>
                        </ui:MultipleAssign.AssignOperations>
                      </ui:MultipleAssign>
                    </Sequence>
                  </If.Else>
                </If>
                <If Condition="[theTemp=&quot;0&quot;]" DisplayName="If temperature value is 0 = UNKNOWN then STOP" sap:VirtualizedContainerService.HintSize="694.666666666667,521.333333333333" sap2010:WorkflowViewState.IdRef="If_9">
                  <If.Then>
                    <Sequence DisplayName="Send an Error Email Notification" sap:VirtualizedContainerService.HintSize="376,367.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_13">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Send the error notification email" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_3" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                      <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Move the original email to the Exceptions queue" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_4" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                      <Throw DisplayName="STOP - no temperature value found" Exception="[new BusinessRuleException(&quot;Temperature for this reply email is: Unknown&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_1" />
                    </Sequence>
                  </If.Then>
                </If>
                <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Move the email to the Processed Queue" sap:VirtualizedContainerService.HintSize="694.666666666667,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_2" MailFolder="[Settings(&quot;HARIAArchiveQueue&quot;).ToString]" MailMessage="[message]" />
                <Assign sap:VirtualizedContainerService.HintSize="694.666666666667,62" sap2010:WorkflowViewState.IdRef="Assign_38">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[MasterFile]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">[Settings("MasterPath").ToString]</InArgument>
                  </Assign.Value>
                </Assign>
                <ui:ExcelApplicationScope Password="{x:Null}" sap2010:Annotation.AnnotationText="Get current employees details from the DISTRIBUTION sheet" DisplayName="Get the employee basic information" sap:VirtualizedContainerService.HintSize="694.666666666667,1878.66666666667" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_2" WorkbookPath="[MasterFile]">
                  <ui:ExcelApplicationScope.Body>
                    <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Start Processing" sap:VirtualizedContainerService.HintSize="660.666666666667,1739.33333333333" sap2010:WorkflowViewState.IdRef="Sequence_18">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ExcelReadRange AddHeaders="True" DataTable="[distributionData]" DisplayName="Get the Distribution list" sap:VirtualizedContainerService.HintSize="618.666666666667,58.6666666666667" sap2010:WorkflowViewState.IdRef="ExcelReadRange_6" SheetName="Distribution">
                          <ui:ExcelReadRange.Range>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" Value="" />
                            </InArgument>
                          </ui:ExcelReadRange.Range>
                        </ui:ExcelReadRange>
                        <ui:FilterDataTable DataTable="[distributionData]" DisplayName="Filter the list to just this employee" FilterRowsMode="Keep" sap:VirtualizedContainerService.HintSize="618.666666666667,58.6666666666667" sap2010:WorkflowViewState.IdRef="FilterDataTable_2" OutputDataTable="[FilteredDistribution]" SelectColumnsMode="Keep">
                          <ui:FilterDataTable.Filters>
                            <scg:List x:TypeArguments="ui:FilterOperationArgument" Capacity="4">
                              <ui:FilterOperationArgument BooleanOperator="And" Operator="CONTAINS">
                                <ui:FilterOperationArgument.Column>
                                  <InArgument x:TypeArguments="x:String">["Email"]</InArgument>
                                </ui:FilterOperationArgument.Column>
                                <ui:FilterOperationArgument.Operand>
                                  <InArgument x:TypeArguments="x:String">[theEmployee]</InArgument>
                                </ui:FilterOperationArgument.Operand>
                              </ui:FilterOperationArgument>
                            </scg:List>
                          </ui:FilterDataTable.Filters>
                          <ui:FilterDataTable.SelectColumns>
                            <scg:List x:TypeArguments="InArgument" Capacity="4">
                              <x:Null />
                            </scg:List>
                          </ui:FilterDataTable.SelectColumns>
                        </ui:FilterDataTable>
                        <If Condition="[FilteredDistribution.Rows.Count &lt; 1]" DisplayName="If employee NOT FOUND" sap:VirtualizedContainerService.HintSize="618.666666666667,610" sap2010:WorkflowViewState.IdRef="If_10">
                          <If.Then>
                            <Sequence DisplayName="Send exception" sap:VirtualizedContainerService.HintSize="418,459.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_15">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Send an Error Email Notification" sap:VirtualizedContainerService.HintSize="376,367.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_14">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Send the error notification email" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_5" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                                <ui:MoveOutlookMessage Account="{x:Null}" DisplayName="Move the original email to the Exceptions queue" sap:VirtualizedContainerService.HintSize="334,86.6666666666667" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_6" MailFolder="[Settings(&quot;HARIAExceptionQueue&quot;).ToString]" MailMessage="[message]" />
                                <Throw DisplayName="STOP - Unknown employee" Exception="[new BusinessRuleException(&quot;Temperature for this reply email is: Unknown&quot;)]" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="Throw_2" />
                              </Sequence>
                            </Sequence>
                          </If.Then>
                        </If>
                        <ui:ForEachRow CurrentIndex="[theCurrentRow]" DataTable="[FilteredDistribution]" DisplayName="If Employee is in the Distribution List" sap:VirtualizedContainerService.HintSize="618.666666666667,800" sap2010:WorkflowViewState.IdRef="ForEachRow_3">
                          <ui:ForEachRow.Body>
                            <ActivityAction x:TypeArguments="sd:DataRow">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="thisEmployee" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Determine the employee details" sap:VirtualizedContainerService.HintSize="568,650.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_17">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[thisEmployee.Item(&quot;Email&quot;).ToString.Contains(theEmployee)]" DisplayName="If we have a matching Employee" sap:VirtualizedContainerService.HintSize="526,432" sap2010:WorkflowViewState.IdRef="If_11">
                                  <If.Then>
                                    <Sequence sap2010:Annotation.AnnotationText="Save the employee details for later" DisplayName="Get the employee details" sap:VirtualizedContainerService.HintSize="380,281.333333333333" sap2010:WorkflowViewState.IdRef="Sequence_16">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,158.666666666667" sap2010:WorkflowViewState.IdRef="MultipleAssign_12">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_101">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[FName]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[thisEmployee.Item("First Name").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_102">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[SName]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[thisEmployee.Item("Last Name").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_103">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[Department]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[thisEmployee.Item("Department").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                    </Sequence>
                                  </If.Then>
                                </If>
                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="526,86.6666666666667" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_2" UnSafe="False" WorkflowFileName="TemperatureUpdateMasterFile.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:String" x:Key="MasterFilei">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="MasterFile" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="theEmployeei">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="theEmployee" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="s:DateTime" x:Key="theStartofWeeki">
                                      <mva:VisualBasicValue x:TypeArguments="s:DateTime" ExpressionText="theStartOfWeek" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="theDayi">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="theDay" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:Int32" x:Key="theIntCelli">
                                      <mva:VisualBasicValue x:TypeArguments="x:Int32" ExpressionText="theIntCell" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="FNamei">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="FName" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="SNamei">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="SName" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="Departmenti">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="Department" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="sd:DataTable" x:Key="EmployeeDatai">
                                      <mva:VisualBasicValue x:TypeArguments="sd:DataTable" ExpressionText="EmployeeData" />
                                    </InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="theTempi">
                                      <mva:VisualBasicValue x:TypeArguments="x:String" ExpressionText="theTemp" />
                                    </InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEachRow.Body>
                        </ui:ForEachRow>
                      </Sequence>
                    </ActivityAction>
                  </ui:ExcelApplicationScope.Body>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ExcelApplicationScope>
              </Sequence>
            </TryCatch.Try>
            <TryCatch.Catches>
              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404.666666666667,22" sap2010:WorkflowViewState.IdRef="Catch`1_1">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ActivityAction x:TypeArguments="s:Exception">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                  </ActivityAction.Argument>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,94.6666666666667" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Error" Message="[exception.Source.ToString+&quot; &quot;+ exception.Message.ToString]" />
                </ActivityAction>
              </Catch>
            </TryCatch.Catches>
          </TryCatch>
        </ActivityAction>
      </ui:ForEach.Body>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </ui:ForEach>
  </Sequence>
</Activity>